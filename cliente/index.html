<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sua Galeria | FS FOTOGRAFIAS</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: #fafafa; color: #1a1a1a; -webkit-user-select: none; user-select: none; }
        img { -webkit-user-drag: none; user-drag: none; pointer-events: none; }

        /* NAV */
        .nav { background: #fff; border-bottom: 1px solid #e5e5e5; position: sticky; top: 0; z-index: 40; }
        .nav-inner { max-width: 1200px; margin: 0 auto; padding: 0 1rem; height: 56px; display: flex; align-items: center; justify-content: space-between; }
        .nav-logo { font-family: 'Playfair Display', serif; font-size: 1.25rem; font-weight: 700; color: #1a1a1a; text-decoration: none; }
        .nav-logo span { color: #2563eb; }
        .nav-back { font-size: 0.8125rem; color: #666; text-decoration: none; }
        .nav-back:hover { color: #1a1a1a; }

        /* LOGIN */
        .login-container { min-height: calc(100vh - 56px); display: flex; align-items: center; justify-content: center; padding: 2rem 1rem; }
        .login-card { background: #fff; border-radius: 1rem; padding: 3rem 2rem; width: 100%; max-width: 400px; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.06); }
        .login-icon { width: 48px; height: 48px; margin: 0 auto 1.5rem; background: #f5f5f5; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .login-icon svg { width: 24px; height: 24px; stroke: #999; fill: none; stroke-width: 2; }
        .login-title { font-family: 'Playfair Display', serif; font-size: 1.5rem; font-weight: 600; margin-bottom: 0.5rem; }
        .login-desc { color: #666; font-size: 0.875rem; margin-bottom: 1.5rem; }
        .login-input { width: 100%; padding: 0.875rem 1rem; border: 1px solid #e0e0e0; border-radius: 0.5rem; font-size: 1rem; outline: none; text-align: center; letter-spacing: 0.15em; font-family: monospace; }
        .login-input:focus { border-color: #1a1a1a; }
        .login-btn { width: 100%; padding: 0.875rem; background: #1a1a1a; color: #fff; border: none; border-radius: 0.5rem; font-size: 0.9375rem; font-weight: 600; cursor: pointer; margin-top: 0.75rem; transition: background 0.2s; }
        .login-btn:hover { background: #333; }
        .login-error { color: #dc2626; font-size: 0.8125rem; margin-top: 0.75rem; display: none; }

        /* GALLERY */
        .gallery-container { display: none; }
        .gallery-header { max-width: 1200px; margin: 0 auto; padding: 1.5rem 1rem 1rem; }
        .gallery-client { font-family: 'Playfair Display', serif; font-size: 1.75rem; font-weight: 600; }
        .gallery-meta { color: #666; font-size: 0.8125rem; margin-top: 0.25rem; }
        .gallery-meta span { margin: 0 0.25rem; }

        /* SELECTION INFO BAR */
        .selection-info { max-width: 1200px; margin: 0 auto; padding: 0 1rem 1rem; }
        .selection-info-bar { background: #fff; border: 1px solid #e5e5e5; border-radius: 0.75rem; padding: 1rem 1.25rem; display: flex; align-items: center; justify-content: space-between; gap: 1rem; flex-wrap: wrap; }
        .selection-count { font-size: 0.9375rem; font-weight: 600; }
        .selection-count .num { font-family: 'Playfair Display', serif; font-size: 1.5rem; color: #1a1a1a; }
        .selection-count .limit { color: #999; }
        .selection-extra { font-size: 0.8125rem; color: #d97706; font-weight: 500; }
        .selection-hint { font-size: 0.75rem; color: #999; }

        /* PHOTO GRID */
        .photo-grid { max-width: 1200px; margin: 0 auto; padding: 0 1rem 8rem; display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.375rem; }
        @media (min-width: 640px) { .photo-grid { grid-template-columns: repeat(3, 1fr); gap: 0.5rem; } }
        @media (min-width: 1024px) { .photo-grid { grid-template-columns: repeat(4, 1fr); gap: 0.5rem; } }

        .photo-item { position: relative; aspect-ratio: 3/4; background: #e5e5e5; border-radius: 0.375rem; overflow: hidden; cursor: pointer; }
        .photo-item img { width: 100%; height: 100%; object-fit: cover; pointer-events: none; transition: transform 0.3s; }
        .photo-item:active img { transform: scale(1.02); }

        /* WATERMARK OVERLAY */
        .watermark-overlay { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; pointer-events: none; overflow: hidden; }
        .watermark-text { font-family: 'Playfair Display', serif; font-size: 1.25rem; color: rgba(255,255,255,0.15); transform: rotate(-35deg); white-space: nowrap; letter-spacing: 0.1em; }
        @media (min-width: 640px) { .watermark-text { font-size: 1.5rem; } }

        /* HEART / SELECT BUTTON */
        .photo-heart { position: absolute; top: 0.5rem; right: 0.5rem; width: 36px; height: 36px; background: rgba(0,0,0,0.4); border: none; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; pointer-events: auto; z-index: 2; }
        .photo-heart:hover { background: rgba(0,0,0,0.6); }
        .photo-heart.selected { background: #dc2626; transform: scale(1.15); }
        .photo-heart svg { width: 18px; height: 18px; stroke: #fff; fill: none; stroke-width: 2; transition: all 0.2s; }
        .photo-heart.selected svg { fill: #fff; }

        /* PHOTO NUMBER */
        .photo-num { position: absolute; bottom: 0.375rem; left: 0.375rem; background: rgba(0,0,0,0.5); color: #fff; font-size: 0.625rem; padding: 0.125rem 0.375rem; border-radius: 0.25rem; pointer-events: none; }

        /* BOTTOM BAR */
        .bottom-bar { position: fixed; bottom: 0; left: 0; right: 0; background: #fff; border-top: 1px solid #e5e5e5; padding: 0.75rem 1rem; z-index: 45; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); }
        .bottom-bar-inner { max-width: 1200px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; gap: 1rem; }
        .bottom-bar-count { font-size: 0.875rem; }
        .bottom-bar-count strong { font-family: 'Playfair Display', serif; font-size: 1.125rem; }
        .bottom-bar-extra { font-size: 0.75rem; color: #d97706; }
        .bottom-bar-btn { background: #1a1a1a; color: #fff; border: none; border-radius: 0.5rem; padding: 0.625rem 1.5rem; font-size: 0.875rem; font-weight: 600; cursor: pointer; transition: background 0.2s; white-space: nowrap; }
        .bottom-bar-btn:hover { background: #333; }
        .bottom-bar-btn:disabled { background: #ccc; cursor: not-allowed; }

        /* LIGHTBOX */
        .lightbox { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 50; flex-direction: column; }
        .lightbox.active { display: flex; }
        .lightbox-header { display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 1rem; }
        .lightbox-counter { color: #aaa; font-size: 0.875rem; }
        .lightbox-close { background: none; border: none; color: #fff; font-size: 1.5rem; cursor: pointer; padding: 0.5rem; }
        .lightbox-body { flex: 1; display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden; }
        .lightbox-img-container { position: relative; max-width: 100%; max-height: 100%; display: flex; align-items: center; justify-content: center; }
        .lightbox-img { max-width: 100%; max-height: calc(100vh - 140px); object-fit: contain; pointer-events: none; }
        .lightbox-watermark { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; pointer-events: none; }
        .lightbox-watermark span { font-family: 'Playfair Display', serif; font-size: 3rem; color: rgba(255,255,255,0.08); transform: rotate(-35deg); white-space: nowrap; letter-spacing: 0.15em; }
        .lightbox-nav { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.1); border: none; color: #fff; width: 44px; height: 44px; border-radius: 50%; cursor: pointer; font-size: 1.25rem; display: flex; align-items: center; justify-content: center; }
        .lightbox-nav:hover { background: rgba(255,255,255,0.2); }
        .lightbox-prev { left: 0.75rem; }
        .lightbox-next { right: 0.75rem; }
        .lightbox-footer { display: flex; justify-content: center; align-items: center; gap: 1rem; padding: 0.75rem 1rem; }
        .lightbox-heart { background: rgba(255,255,255,0.1); border: none; border-radius: 50%; width: 48px; height: 48px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
        .lightbox-heart:hover { background: rgba(255,255,255,0.2); }
        .lightbox-heart.selected { background: #dc2626; }
        .lightbox-heart svg { width: 24px; height: 24px; stroke: #fff; fill: none; stroke-width: 2; }
        .lightbox-heart.selected svg { fill: #fff; }
        .lightbox-download { background: rgba(255,255,255,0.1); border: none; border-radius: 50%; width: 48px; height: 48px; cursor: pointer; display: flex; align-items: center; justify-content: center; text-decoration: none; }
        .lightbox-download:hover { background: rgba(255,255,255,0.2); }
        .lightbox-download svg { width: 22px; height: 22px; stroke: #fff; fill: none; stroke-width: 2; }

        /* STATUS SCREENS */
        .status-screen { display: none; max-width: 500px; margin: 3rem auto; padding: 3rem 2rem; text-align: center; }
        .status-screen.active { display: block; }
        .status-icon { width: 64px; height: 64px; margin: 0 auto 1.5rem; background: #f0fdf4; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .status-icon.waiting { background: #fef3c7; }
        .status-icon svg { width: 32px; height: 32px; }
        .status-title { font-family: 'Playfair Display', serif; font-size: 1.5rem; font-weight: 600; margin-bottom: 0.5rem; }
        .status-desc { color: #666; font-size: 0.9375rem; line-height: 1.6; }

        /* GALLERY MODE (download) */
        .photo-download { position: absolute; inset: 0; background: rgba(0,0,0,0.4); opacity: 0; transition: opacity 0.2s; display: flex; align-items: center; justify-content: center; pointer-events: none; }
        .photo-item:hover .photo-download { opacity: 1; }
        .photo-download a { background: #fff; color: #1a1a1a; padding: 0.5rem 1rem; border-radius: 0.375rem; font-size: 0.8125rem; font-weight: 600; text-decoration: none; pointer-events: auto; display: flex; align-items: center; gap: 0.375rem; }
        .photo-download a svg { width: 16px; height: 16px; stroke: currentColor; fill: none; stroke-width: 2; }
    </style>
</head>
<body oncontextmenu="return false">

    <!-- NAV -->
    <nav class="nav">
        <div class="nav-inner">
            <a href="/" class="nav-logo">FS<span>.</span>FOTOGRAFIAS</a>
            <a href="/" class="nav-back">Voltar ao Site</a>
        </div>
    </nav>

    <!-- LOGIN -->
    <div id="loginSection" class="login-container">
        <div class="login-card">
            <div class="login-icon">
                <svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
            </div>
            <h1 class="login-title">Acesso a Galeria</h1>
            <p class="login-desc">Insira o codigo fornecido pelo fotografo</p>
            <form id="loginForm">
                <input type="text" id="accessCode" class="login-input" placeholder="CODIGO" autocomplete="off" required>
                <button type="submit" id="loginBtn" class="login-btn">Acessar</button>
            </form>
            <p id="errorMessage" class="login-error"></p>
        </div>
    </div>

    <!-- GALLERY -->
    <div id="gallerySection" class="gallery-container">
        <div class="gallery-header">
            <h1 id="clientName" class="gallery-client"></h1>
            <p id="galleryMeta" class="gallery-meta"></p>
        </div>

        <!-- Selection info (only in selection mode) -->
        <div id="selectionInfo" class="selection-info" style="display:none;">
            <div class="selection-info-bar">
                <div class="selection-count">
                    <span class="num" id="selectedNum">0</span>
                    <span class="limit">/ <span id="limitNum">30</span> fotos</span>
                </div>
                <div id="extraInfo" class="selection-extra" style="display:none;"></div>
                <div class="selection-hint">Toque nas fotos para selecionar</div>
            </div>
        </div>

        <div id="photosGrid" class="photo-grid"></div>

        <!-- Status: submitted -->
        <div id="statusSubmitted" class="status-screen">
            <div class="status-icon">
                <svg viewBox="0 0 24 24" stroke="#16a34a" fill="none" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
            </div>
            <h2 class="status-title">Selecao Enviada!</h2>
            <p class="status-desc">Suas fotos favoritas foram enviadas ao fotografo. Aguarde o processamento.</p>
            <button id="requestReopenBtn" onclick="requestReopen()" style="margin-top:1.25rem; background:none; border:1px solid #d1d5db; color:#666; padding:0.625rem 1.25rem; border-radius:0.5rem; font-size:0.8125rem; cursor:pointer; transition:all 0.2s;">
                Preciso alterar minha selecao
            </button>
            <p id="reopenSent" style="display:none; color:#16a34a; font-size:0.8125rem; margin-top:1rem;">Pedido enviado! Aguarde o fotografo reabrir a selecao.</p>
            <p style="color:#999; font-size:0.8125rem; margin-top:1rem;">Veja abaixo as fotos que voce selecionou:</p>
        </div>

        <!-- Grid de fotos selecionadas (apos submit) -->
        <div id="submittedPhotosGrid" class="photo-grid" style="display:none;"></div>

        <!-- Status: waiting delivery -->
        <div id="statusWaiting" class="status-screen">
            <div class="status-icon waiting">
                <svg viewBox="0 0 24 24" stroke="#d97706" fill="none" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            </div>
            <h2 class="status-title">Aguardando Processamento</h2>
            <p class="status-desc">O fotografo esta processando suas fotos selecionadas. Volte em breve para baixar em alta resolucao.</p>
        </div>
    </div>

    <!-- BOTTOM BAR (selection mode) -->
    <div id="bottomBar" class="bottom-bar" style="display:none;">
        <div class="bottom-bar-inner">
            <div>
                <div class="bottom-bar-count">
                    <strong id="barCount">0</strong> / <span id="barLimit">30</span> fotos
                </div>
                <div id="barExtra" class="bottom-bar-extra" style="display:none;"></div>
            </div>
            <button id="submitBtn" class="bottom-bar-btn" onclick="submitSelection()">Finalizar Selecao</button>
        </div>
    </div>

    <!-- LIGHTBOX -->
    <div id="lightbox" class="lightbox">
        <div class="lightbox-header">
            <span id="lightboxCounter" class="lightbox-counter"></span>
            <button class="lightbox-close" onclick="closeLightbox()">&times;</button>
        </div>
        <div class="lightbox-body">
            <div class="lightbox-img-container">
                <img id="lightboxImg" class="lightbox-img" src="" alt="">
                <div id="lightboxWatermark" class="lightbox-watermark">
                    <span>FS FOTOGRAFIAS</span>
                </div>
            </div>
            <button class="lightbox-nav lightbox-prev" onclick="lightboxNav(-1)">&#8249;</button>
            <button class="lightbox-nav lightbox-next" onclick="lightboxNav(1)">&#8250;</button>
        </div>
        <div class="lightbox-footer">
            <button id="lightboxHeart" class="lightbox-heart" onclick="toggleLightboxHeart()">
                <svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
            </button>
            <a id="lightboxDownload" class="lightbox-download" href="#" download style="display:none;">
                <svg viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            </a>
        </div>
    </div>

    <script src="/cliente/js/gallery.js"></script>
</body>
</html>
